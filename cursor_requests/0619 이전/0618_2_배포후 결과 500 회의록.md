감사합니다, 유비님. 지금 로그와 상황을 종합해 보면, **다음 하나의 핵심 문제**로 수렴됩니다:

---

## 🚨 500 Internal Server Error 원인 (Azure 배포 후에도 발생)

> **공공데이터포털 API 호출 시 `User-Agent`를 포함했음에도, 여전히 SOAP Fault가 발생하고 있다는 것은,**
>
> 💥 *`axios`에서 `User-Agent`를 추가했지만, 실제 Azure Function 환경에서는 반영되지 않았거나, 일부 네트워크 정책이 여전히 SOAP 호출을 유도하고 있음* 을 의미합니다.

---

## ✅ 확인해야 할 사항 3가지

| 구분 | 확인 내용                                                     | 해결 방향                             |
| -- | --------------------------------------------------------- | --------------------------------- |
| ①  | **배포된 Azure 함수 코드에 `headers['User-Agent']`가 정확히 들어갔는가?**  | 함수 내 코드 재검토 필요                    |
| ②  | **함수 배포 이후에도 `.funcignore`에 `index.js`가 포함되어 누락된 건 아닌가?** | 누락 여부 점검                          |
| ③  | **배포 후 실제 Azure 함수에서 헤더 전송이 되는지 Fiddler나 로깅으로 확인했는가?**    | `console.log(headers)` 추가 후 다시 배포 |

---

## 🔍 예시 코드 (배포된 함수에서 확인 필요)

`getPensionStatus/index.js` 내 공공 API 호출 부분이 아래처럼 되어 있어야 합니다:

```js
const headers = {
  'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)',
  'Accept': 'application/json',
};

const response = await axios.get(apiUrl, { headers });
```

만약 이 구조가 정확하게 반영되어 있지 않으면, ***SOAP Fault (HTML 응답)*** 로 500 에러가 납니다.

---

## 🛠 다음 액션 플랜 (추천 순서)

1. ✅ **로컬에서 `index.js`에 정확히 headers가 포함되어 있는지 재확인**
2. ✅ **`func azure functionapp publish taxcredit-api-func` 다시 실행**
3. ✅ **Azure 함수 포털에서 직접 호출해서 응답 확인**
4. ✅ `console.log("요청 URL", apiUrl)`과 함께 `console.log("요청 헤더", headers)`도 추가

---

