# 요청서\_20250619\_016 — 단건 조회 API 500 응답 → 200 + 실패 메시지로 수정

## 🧾 작업 목적

국민연금 단건 조회 함수(`getPensionStatus`) 호출 시, 공공데이터 API에서 오류 응답이 오면 내부적으로 `resultCode !== '00'` 조건에서 **HTTP 500 응답을 강제로 반환**하고 있음. 이로 인해 프론트에서는 함수 호출이 실패한 것으로 인식되어 **"HTTP error! status: 500"** 메시지를 반복 출력하게 되며, 실제 오류 원인과 분리된 오작동 상태를 유발함. 이에 따라 응답 코드를 **항상 200으로 고정**하고, 실제 오류 여부는 응답 JSON 내 `success: false`와 `error` 메시지로 전달하도록 수정함.

---

## 🔍 문제 요약

| 항목    | 내용                                                     |
| ----- | ------------------------------------------------------ |
| 문제 함수 | `getPensionStatus` (Azure Function)                    |
| 발생 조건 | 국민연금 API `resultCode !== "00"` 반환 시                    |
| 현재 응답 | `status: 500` + JSON 오류 메시지                            |
| 예상 응답 | `status: 200` + `success: false`, `error: ...` 포함 JSON |

---

## ✏️ 수정 지시사항

```ts
// ❌ 현재 잘못된 방식
if (resultCode !== '00') {
  context.res = {
    status: 500,
    body: {
      success: false,
      error: `국민연금 API 오류: ${resultCode} - ${resultMsg}`,
    },
  };
  return;
}

// ✅ 아래와 같이 수정
if (resultCode !== '00') {
  context.res = {
    status: 200,
    body: {
      success: false,
      error: `국민연금 API 오류: ${resultCode} - ${resultMsg}`,
    },
  };
  return;
}
```

> ❗ HTTP 500 응답은 **서버 자체의 실행 오류**가 아닌 경우 사용하지 않도록 주의

---

## 📂 참고 문서

* `요청서_20250619_015`: UI에서 500 응답으로 인해 에러 메시지 출력됨 확인
* `Session_20250619_Masking_OK`: 단건 조회 구조 기준

---

> 🎯 본 수정은 사용자 경험과 로그 해석 혼란을 방지하기 위한 기본적인 API 설계 안정화 조치임. 이후 모든 실패 응답은 `200 OK + success: false` 패턴을 기본으로 적용할 것.
